input {
    file {
        path => "C:/Users/natal/OneDrive/Documentos/0_Universidad/10-Master/2_Curso_2019-2020/Tercer_Trimestre/4_Recuperacion_datos/0-SOFTWARE/logstash-7.6.2/data/911.csv"
	    start_position => beginning
	    sincedb_path => "NUL"
    }
}
filter {
    csv {
        separator=> ","
        columns =>["lat","lng","desc","zip","title","timeStamp","twp","addr","e"]
        }
    dissect {
          mapping => {"timeStamp"=> "%{Date} %{Hour}"}
          mapping => {"title" => "%{TypeEmerg} %{Motive}"}
          }

    mutate {
            convert => {
               "lat" => "float"
               "lng" => "float"
               "zip" => "integer"
               }
              add_field =>{
                "location" => "%{lat},%{lng}"
              }
	    remove_field => ["message", "@version","@timestamp", "host", "path", "lat", "lng", "e","desc","timeStamp","Hour"]
     }
}
output {
    elasticsearch {
	    hosts => ["localhost:9200"]
        index => "911"
     }
	 stdout{}
}

